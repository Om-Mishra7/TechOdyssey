{% extends 'private/base.html' %}

{% block main %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">

<h1>Stats</h1>

<div class="stats-container">
    <h3>Basic Application Stats</h3>

    <p>Number of users: {{ number_of_application_users }}</p>
    <p>Number of event registrations: {{ number_of_event_registrations }}</p>

</div>

<div class="user-stats-container">
    <h3>User Stats</h3>

    {% for user in application_users %}
    <div class="user-stats">
        <div class="user-image">
            <img src="{{ user.user_info.user_avatar_url }}" alt="User Image">
        </div>
        <div class="user-info">
            <p>User ID: {{ user._id }}</p>
            <p>Name: {{ user.user_info.user_name }}</p>
            <p>Email: {{ user.user_email }}</p>
        </div>
    </div>
    {% endfor %}
</div>

<div class="registration-stats-container">
    <h3>Event Registration Stats</h3>

    {% for registration in event_registrations %}
   <div class="registration-stats" style="background-color: #222; color: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
    <div class="registration-info">
        <p style="margin: 5px 0;">Registration ID: {{ registration._id }}</p>
        <p style="margin: 5px 0;">Event Name: {{ registration.event }}</p>
        <p style="margin: 5px 0;">User Name: {{ registration.name }}</p>
        <p style="margin: 5px 0;">User Email: {{ registration.email }}</p>
        <p style="margin: 5px 0;">Approval Status: {{ registration.status | capitalize }}</p>
        <p style="margin: 5px 0;">Payment Screenshot: <a style="padding: 5px; background-color: #333; border-radius: 5px; text-decoration: none; color: #fff;" href="{{ registration.paymentScreenshot }}">View</a></p>
        <br>
        {% if registration.status == 'pending' %}
        <button style="margin-right: 10px; background-color: #007bff; color: #fff; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;" onclick="window.location.href='/admin/{{ registration._id }}/approve'">Approve</button>
        <button style="background-color: #dc3545; color: #fff; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;" onclick="window.location.href='/admin/{{ registration._id }}/reject'">Reject</button>
        {% endif %}
    </div>
</div>
    {% endfor %}
</div>

{% endblock %}
